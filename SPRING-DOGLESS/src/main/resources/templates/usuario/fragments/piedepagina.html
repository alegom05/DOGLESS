<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
  </head>
  <body>
    <div th:fragment="fragment">
      <!-- Pie de página -->
      <footer class="footer">
        <div>
          <div class="row align-items-center">
            <div class="col-md-4">
              <h2>DOGLESS</h2>
            </div>
            <div class="col-md-4 offset-md-4 d-flex justify-content-center">
              <button type="button" class="btn btn-icon btn-round btn-primary mx-1">
                <i class="fab fa-facebook-f"></i>
              </button>
              <button type="button" class="btn btn-icon btn-round btn-info mx-1">
                <i class="fab fa-twitter"></i>
              </button>
              <button type="button" class="btn btn-icon btn-round btn-secondary mx-1">
                <i class="fab fa-linkedin-in"></i>
              </button>
              <button type="button" class="btn btn-icon btn-round btn-danger mx-1">
                <i class="fab fa-youtube"></i>
              </button>

            </div>
          </div>
        </div>
        <hr class="my-2">

        <div class="row">
          <div class="col-md-3">
            <h5>Sobre nosotros</h5>
            <ul class="list-unstyled">
              <li><a href="/usuario/informacion-de-contacto" class="footer-link d-block pb-2">Acerca de dogless</a></li>
              <li><a href="/usuario/terminosycondiciones" class="footer-link d-block pb-2">Términos y condiciones</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Numero de RUC</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Licenciamiento</a></li>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Cuenta</h5>
            <ul class="list-unstyled">
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Crear cuenta</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Pago</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Envio</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Soporte</a></li>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Guia de compra</h5>
            <ul class="list-unstyled">
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Mi cuenta</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Mis pedidos</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Favoritos</a></li>
              <li><a href="javascript:void(0)" class="footer-link d-block pb-2">Devoluciones</a></li>
            </ul>
          </div>
          <div class="col-md-3">
            <h5>Métodos de pago</h5>
            <div class="payment-methods">
              <img src="/assetsUsuario/img/logo-visa.png" alt="Visa" class="img-fluid w-25 mx-2">
              <img src="/assetsUsuario/img/logo-mastercard.png" alt="Mastercard" class="img-fluid w-25 mx-2">
            </div>
          </div>
        </div>
        <div class="row">
          <h7>@2024-2090 Dogless.com, todos los derechos reservados</h7>
        </div>

      </footer>
    </div>
    <!-- Chat Widget -->
    <div class="chat-widget-container">
      <button class="chat-button" id="chatButton">
        <i class="fas fa-comments"></i>
      </button>

      <div class="chat-modal" id="chatModal">
        <div class="chat-header">
          <h4>Chat de Ayuda</h4>
        </div>
        <div class="chat-messages" id="chatMessages">
          <!-- Los mensajes se agregarán aquí dinámicamente -->
        </div>
        <div class="chat-input">
          <input type="text" id="messageInput" placeholder="Escribe un mensaje...">
          <button id="sendMessage">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>
    <div th:fragment="scripts">
      <!-- Core JS Files -->
      <script th:src="@{/assets/js/core/jquery-3.7.1.min.js}"></script>
      <script th:src="@{/assets/js/core/bootstrap.min.js}"></script>
      <!-- DataTables -->
      <script th:src="@{/assets/js/plugin/datatables/datatables.min.js}"></script>
      <!-- Custom JS -->
      <script th:src="@{/js/chat.js}"></script>
    </div>
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Configuración del chat
        const chatButton = document.getElementById('chatButton');
        const chatModal = document.getElementById('chatModal');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendMessage');
        const chatMessages = document.getElementById('chatMessages');

        if (chatButton) {  // Verificar que el elemento existe
          chatButton.addEventListener('click', function() {
            chatModal.classList.toggle('active');
          });
        }

        function sendMessage() {
          const message = messageInput?.value?.trim();
          if (message) {
            // Añadir mensaje del usuario
            addMessage(message, 'user');

            // Enviar al backend
            fetch('/api/chat/send', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json'
              },
              body: JSON.stringify({ content: message })
            })
                    .then(response => response.json())
                    .then(data => {
                      addMessage(data.content, 'bot');
                    })
                    .catch(error => {
                      console.error('Error:', error);
                      addMessage('Lo siento, hubo un error al procesar tu mensaje.', 'bot');
                    });

            messageInput.value = '';
          }
        }

        function addMessage(message, type) {
          if (chatMessages) {  // Verificar que el elemento existe
            const messageElement = document.createElement('div');
            messageElement.classList.add('message', `${type}-message`);
            messageElement.textContent = message;
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
          }
        }

        // Event listeners
        if (sendButton) {  // Verificar que el elemento existe
          sendButton.addEventListener('click', sendMessage);
        }

        if (messageInput) {  // Verificar que el elemento existe
          messageInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
              sendMessage();
            }
          });
        }
      });
    </script>


  </body>
</html>
